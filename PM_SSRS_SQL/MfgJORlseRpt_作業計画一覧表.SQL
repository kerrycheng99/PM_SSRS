--MfgJORlseRpt_作業計画一覧表SQL
DECLARE @SCH_ID VARCHAR(10) = ''
DECLARE @WS_CD VARCHAR(10) = ''
DECLARE @SCH_START_DATE INT = 0

SELECT
PO.SCH_ID,    S1.DATA_CHAR SCH_NAME,  PO.SCH_START_DATE,  PO.WS_CD,
W.WS_DESC,      PO.ORDER_NO,            PO.ITEM_NO,         PO.ITEM_DESC,
PO.ORDER_QTY,    PO.ORDER_UMSR,          JO.PROCESS_CD,      PM.PROCESS_DESC,
JO.SCH_SETUP_TIME,   JO.SCH_WORK_TIME,   JO.SCH_TRANSFER_TIME,
S2.DATA_CHAR UMSR_NAME,
PO.SCH_COMPL_DATE,       PO.JOC_CD,      PO.WHS_CD,          WH.WHS_DESC
FROM PLANNED_ORDER PO
LEFT OUTER JOIN SYSTEM_PARAMETER S1 ON PO.SCH_ID      = S1.KEY02 AND S1.KEY01 = 'SCH_ID'
LEFT OUTER JOIN SYSTEM_PARAMETER S2 ON PO.ORDER_UMSR  = S2.KEY02 AND S2.KEY01 = 'ITEM_UMSR'
LEFT OUTER JOIN WORKSHOP_MASTER  W  ON PO.WS_CD       = W.WS_CD
LEFT OUTER JOIN JOB_ORDER_DETAIL JO ON JO.ORDER_NO    = PO.ORDER_NO    
LEFT OUTER JOIN PROCESS_MASTER   PM ON PM.WS_CD       = JO.WS_CD AND JO.PROCESS_CD = PM.PROCESS_CD
LEFT OUTER JOIN WAREHOUSE_MASTER WH ON PO.WHS_CD      = WH.WHS_CD       
WHERE 1 = 1
  AND PO.SC_FLAG = 0
  AND PO.ITEM_TYPE <> '99'
  AND (PO.SCH_ID = @SCH_ID or @SCH_ID = '')
  AND (PO.WS_CD = @WS_CD or @WS_CD = '')
  AND (PO.SCH_START_DATE  <= @SCH_START_DATE or @SCH_START_DATE = 0)
ORDER BY PO.ORDER_NO,JO.PROCESS_SEQ
