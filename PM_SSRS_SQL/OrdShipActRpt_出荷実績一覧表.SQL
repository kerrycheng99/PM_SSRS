--出荷実績一覧表SQL (OrdShipActRpt)
 SELECT
 SO.CUST_CD+'-'+SO.CUST_SUB_CD CUST_NO,CUST1.CUST_NAME,  CUST2.CUST_NAME SHIP_NAME,
 SO.SHIP_TO_CD+'-'+SO.SHIP_TO_SUB_CD SHIP_TO_NO,  SOD.ORDER_NO+'-'+CONVERT(varchar,SOD.ORDER_LINE_NO) ORDER_NO,
 SO.CUST_ORDER_NO,    SOD.ITEM_NO,           I.ITEM_DESC,            SS.SHIP_NO,
 SS.ACTUAL_SHIP_QTY,  SOD.UNIT_PRICE,        SOD.CURRENCY,           WHS.WHS_DESC, 
 SOD.DELIV_DATE,      S1.DATA_CHAR CUR_NAME, S2.DATA_CHAR SCH_NAME,  SOD.JOC_CD,
 SOD.SHIP_WHS WHS_CD,
 SS.ACTUAL_SHIP_DATE, S3.DATA_CHAR UMSR
,ISNULL(S1.DATA_DEC,0) PRC_DEC, ISNULL(S1.DATA_DEC2,0) AMT_DEC
 FROM SHIPPING_SCHEDULE SS
 LEFT OUTER JOIN SALES_ORDER SO ON SS.ORDER_NO = SO.ORDER_NO
 LEFT OUTER JOIN SALES_ORDER_DETAIL SOD ON SS.ORDER_NO = SOD.ORDER_NO    
 AND SS.ORDER_LINE_NO        = SOD.ORDER_LINE_NO
 LEFT OUTER JOIN ITEM_MASTER I ON SOD.ITEM_NO          = I.ITEM_NO
 LEFT OUTER JOIN WAREHOUSE_MASTER WHS ON SOD.SHIP_WHS  = WHS.WHS_CD
 LEFT OUTER JOIN CUSTOMER_MASTER CUST1 ON SO.CUST_CD   = CUST1.CUST_CD 
 AND SO.CUST_SUB_CD       = CUST1.CUST_SUB_CD
 LEFT OUTER JOIN CUSTOMER_MASTER CUST2 ON SO.SHIP_TO_CD= CUST2.CUST_CD 
 AND SO.SHIP_TO_SUB_CD       = CUST2.CUST_SUB_CD
 LEFT OUTER JOIN SYSTEM_PARAMETER S1 ON S1.KEY01       = 'CURRENCY_CD' 
 AND S1.KEY02                = SOD.CURRENCY
 LEFT OUTER JOIN SYSTEM_PARAMETER S2 ON S2.KEY01       = 'SCH_ID'
 AND S2.KEY02                = I.SCH_ID
 LEFT OUTER JOIN SYSTEM_PARAMETER S3 ON S3.KEY01       = 'ITEM_UMSR' 
 AND S3.KEY02                = I.ITEM_UMSR
 WHERE SS.ORDER_STATUS       = 90
 AND (SS.ACTUAL_SHIP_DATE >= @ACTUAL_SHIP_DATE_BEG or @ACTUAL_SHIP_DATE_BEG = 0)
  AND (SS.ACTUAL_SHIP_DATE <= @ACTUAL_SHIP_DATE_END or @ACTUAL_SHIP_DATE_END = 0) 
 ORDER BY SS.ACTUAL_SHIP_DATE,SO.CUST_CD,SO.CUST_SUB_CD,
 SO.SHIP_TO_CD,SO.SHIP_TO_SUB_CD,SOD.ORDER_NO
