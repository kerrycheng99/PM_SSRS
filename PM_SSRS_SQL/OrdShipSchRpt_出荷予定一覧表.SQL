--出荷予定一覧表SQL OrdShipSchRpt
SELECT
 SOD.SHIP_REQ_DATE
,SOD.ITEM_NO
,I.ITEM_DESC
,SOD.ORDER_QTY
,SOD.ACTUAL_SHIP_QTY
,SOD.ORDER_QTY-SOD.ACTUAL_SHIP_QTY SHIP_QTY
,I.ITEM_UMSR
,SOD.DELIV_DATE
,SO.ORDER_NO
,SO.CUST_ORDER_NO
,SO.CUST_CD+'-'+SO.CUST_SUB_CD CUST_NO
,CM.CUST_NAME
,SO.SHIP_TO_CD+'-'+SO.SHIP_TO_SUB_CD SHIP_NO
,CM.CUST_NAME SHIP_NAME
,SO.ADDRESS1
,I.SCH_ID
,SP.DATA_CHAR SCH_NAME
,SOD.JOC_CD
,S1.DATA_CHAR UMSR_NAME
,SOD.SHIP_WHS
FROM SALES_ORDER SO
INNER JOIN SALES_ORDER_DETAIL SOD 
   ON SO.ORDER_NO = SOD.ORDER_NO AND SOD.ORDER_STATUS < 90
LEFT OUTER JOIN CUSTOMER_MASTER CM 
  ON SO.CUST_CD = CM.CUST_CD AND SO.CUST_SUB_CD = CM.CUST_SUB_CD
LEFT OUTER JOIN CUSTOMER_MASTER CM1 
  ON SO.SHIP_TO_CD = CM1.CUST_CD AND SO.SHIP_TO_SUB_CD = CM1.CUST_SUB_CD
LEFT OUTER JOIN ITEM_MASTER I ON SOD.ITEM_NO = I.ITEM_NO
LEFT OUTER JOIN SYSTEM_PARAMETER S1 
  ON S1.KEY01 = 'ITEM_UMSR' AND S1.KEY02 = I.ITEM_UMSR
LEFT OUTER JOIN SYSTEM_PARAMETER SP 
  ON SP.KEY01 = 'SCH_ID'  AND SP.KEY02 = I.SCH_ID
WHERE 1 = 1
  AND SO.ORDER_STATUS < 90
  AND SO.PO_TYPE = 0
  AND (SOD.SHIP_REQ_DATE >= @SCH_SHIP_DATE_BEG or @SCH_SHIP_DATE_BEG=0)
  AND (SOD.SHIP_REQ_DATE <= @SCH_SHIP_DATE_END or @SCH_SHIP_DATE_END=0) 
ORDER BY SOD.SHIP_REQ_DATE
