--PurInspRpt_検収実績一覧表SQL
DECLARE @VENDOR_CD VARCHAR(10) = ''
DECLARE @BEG_EFF_DATE INT = 0
DECLARE @END_EFF_DATE INT = 0

SELECT
AP.TRANS_DATE                   ,AP.FROM_VC_CD             ,CASE AP.PO_NO WHEN NULL  THEN NULL WHEN '' 
THEN NULL  ELSE  AP.PO_NO+RIGHT('000'+CONVERT(VARCHAR(3),AP.PO_LINE_NO),3) END AS PO_NO  ,
AP.ITEM_NO                      ,AP.ITEM_DESC              ,PUR.PO_QTY          ,
PUR.PO_UMSR                     ,AP.REJ_QTY                ,AP.QTY              ,
AP.ACT_PRC                      ,AP.ACT_AMT                ,AP.PO_CUR           ,
W.WHS_DESC                      ,AP.TO_VC_CD               ,V.VENDOR_NAME,      AP.TO_JOC_CD   ,
PUR.BUYER_CD                    ,PUR.SCH_ID                ,PUR.JOC_CD     ,
S1.DATA_CHAR AS BUYER_NAME      ,S2.DATA_CHAR AS SCH_NAME , PUR.WHS_CD     ,
S3.DATA_CHAR AS ITEM_NAME       ,S4.DATA_CHAR AS CUR_NAME
,ISNULL(S4.DATA_DEC,0) PRC_DEC,   ISNULL(S4.DATA_DEC2,0) AMT_DEC
FROM AP_TRANS AP
LEFT JOIN  PUR_ORDER         PUR ON AP.PO_NO=PUR.PO_NO AND AP.PO_LINE_NO=PUR.PO_LINE_NO
LEFT JOIN  WAREHOUSE_MASTER  W   ON PUR.WHS_CD=W.WHS_CD
LEFT JOIN  VENDOR_MASTER     V   ON AP.FROM_VC_CD=V.VENDOR_CD
LEFT JOIN  SYSTEM_PARAMETER  S1  ON PUR.BUYER_CD=S1.KEY02 AND S1.KEY01='BUYER_CD'
LEFT JOIN  SYSTEM_PARAMETER  S2  ON PUR.SCH_ID=S2.KEY02   AND S2.KEY01='SCH_ID'
LEFT JOIN  SYSTEM_PARAMETER  S3  ON PUR.PO_UMSR=S3.KEY02  AND S3.KEY01='ITEM_UMSR'
LEFT JOIN  SYSTEM_PARAMETER  S4  ON AP.PO_CUR=S4.KEY02    AND S4.KEY01='CURRENCY_CD'
WHERE  1=1
  AND (AP.FROM_VC_CD = @VENDOR_CD or @VENDOR_CD = '')
  AND (AP.TRANS_DATE >= @BEG_EFF_DATE or @BEG_EFF_DATE = 0) 
  AND (AP.TRANS_DATE <= @END_EFF_DATE or @END_EFF_DATE = 0) 
ORDER  BY  AP.TRANS_DATE,  AP.FROM_VC_CD ,AP.PO_NO, AP.SLIP_NO