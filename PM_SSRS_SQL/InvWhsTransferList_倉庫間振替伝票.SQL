--InvWhsTransferList_倉庫間振替伝票 SQL
DECLARE @IS_REISSUE Bit = 1         --発行分類: 0.発行 1.再発行
DECLARE @WHS_CD VARCHAR(10) = ''
DECLARE @REQ_TYPE INT = 31          --依頼タイプ 31:倉庫間振替依頼

 SELECT
 T.SLIP_NO,          T.XFER_SCH_DATE,                T.FROM_WHS_CD,
 WHS1.WHS_DESC FROM_WHS_DESC,        T.TO_WHS_CD,    WHS2.WHS_DESC TO_WHS_DESC,
 T.SLIP_LINE_NO,     T.ITEM_NO,      T.ITEM_DESC,    T.FROM_LOCATION,    T.TO_LOCATION,
 T.TO_LOT_NO,        T.TO_JOC_CD,    T.INST_QTY,     S.DATA_CHAR ITEM_UMSR
 FROM TRANSFER_TRANS T
 LEFT OUTER JOIN WAREHOUSE_MASTER WHS2 ON T.TO_WHS_CD  =WHS2.WHS_CD
 LEFT OUTER JOIN WAREHOUSE_MASTER WHS1 ON T.FROM_WHS_CD=WHS1.WHS_CD
 LEFT OUTER JOIN SYSTEM_PARAMETER S ON S.KEY01 = 'ITEM_UMSR' AND S.KEY02 = T.ITEM_UMSR
 WHERE  1 = 1
 AND T.REQ_TYPE = @REQ_TYPE 
 AND ( (@IS_REISSUE = 0  --0.発行
        and T.XFER_STATUS=0
       ) or 
       (@IS_REISSUE = 1  --1.再発行
        AND T.XFER_STATUS=10
       )
     )
 AND (T.FROM_WHS_CD   =       @FROM_WHS_CD or @FROM_WHS_CD = '')
 ORDER BY
 T.FROM_WHS_CD,  T.XFER_SCH_DATE,    T.SLIP_NO,      T.SLIP_LINE_NO,     T.ITEM_NO