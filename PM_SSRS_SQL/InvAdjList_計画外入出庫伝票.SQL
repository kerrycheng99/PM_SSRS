--InvDisbListI_計画外入庫伝票 SQL
DECLARE @IS_REISSUE Bit = 1              --発行分類: 0.発行 1.再発行
DECLARE @WHS_CD VARCHAR(10) = ''

 SELECT
 T.SLIP_NO,      T.XFER_SCH_DATE,        T.TO_WHS_CD,    W.WHS_DESC, 
 T.SLIP_LINE_NO, T.XFER_TEXT,            T.ITEM_NO,      T.ITEM_DESC,        T.INST_QTY,
 S.DATA_CHAR ITEM_UMSR,                  T.TO_LOCATION,  T.TO_LOT_NO,        T.TO_JOC_CD,
 T.FROM_VC_CD,   V.VENDOR_NAME,          T.TO_SUPPLY_TYPE SUPPLY_TYPE
 FROM TRANSFER_TRANS T
 INNER JOIN WAREHOUSE_MASTER W ON T.TO_WHS_CD=W.WHS_CD
 LEFT OUTER JOIN SYSTEM_PARAMETER S ON S.KEY01 = 'ITEM_UMSR' AND S.KEY02 = T.ITEM_UMSR
 LEFT OUTER JOIN VENDOR_MASTER V ON T.FROM_VC_CD=V.VENDOR_CD
 WHERE 1 = 1
 AND T.REQ_TYPE='13'
 AND ( (@IS_REISSUE = 0  --0.発行
        and T.XFER_STATUS=0
       ) or 
       (@IS_REISSUE = 1  --1.再発行
        AND T.XFER_STATUS=10
       ) 
     )             
AND (T.TO_WHS_CD = @WHS_CD or @WHS_CD = '')
ORDER BY T.TO_WHS_CD,T.XFER_SCH_DATE,T.SLIP_NO,T.SLIP_LINE_NO 

--InvDisbListO_計画外出庫伝票 SQL
 SELECT
 T.SLIP_NO,      T.XFER_SCH_DATE,    T.FROM_WHS_CD,      W.WHS_DESC,
 T.TO_WS_CD,     WS.WS_DESC,         T.SLIP_LINE_NO,     T.XFER_TEXT,
 T.ITEM_NO,      T.ITEM_DESC,        D.ALLOC_QTY,        S.DATA_CHAR ITEM_UMSR,
 D.LOCATION,     D.LOT_NO,           D.JOC_CD,           T.FROM_SUPPLY_TYPE SUPPLY_TYPE
 FROM TRANSFER_TRANS T 
 INNER JOIN DISB_ALLOC D ON T.XFER_NO=D.XFER_NO 
 LEFT OUTER JOIN WORKSHOP_MASTER WS ON T.TO_WS_CD=WS.WS_CD 
 LEFT OUTER JOIN WAREHOUSE_MASTER W ON T.FROM_WHS_CD=W.WHS_CD 
 LEFT OUTER JOIN SYSTEM_PARAMETER S ON S.KEY01 = 'ITEM_UMSR' AND S.KEY02 = T.ITEM_UMSR 
 WHERE 1 = 1
 AND T.REQ_TYPE='23' 
 AND D.ALLOC_STATUS=0 
 AND ( (@IS_REISSUE = 0  --0.発行
        and T.XFER_STATUS=0
       ) or 
       (@IS_REISSUE = 1  --1.再発行
        AND T.XFER_STATUS=10
       ) 
     )             
AND (T.FROM_WHS_CD = @WHS_CD or @WHS_CD = '')
ORDER BY 
 T.XFER_SCH_DATE,T.FROM_WHS_CD,T.TO_WS_CD,
 T.SLIP_NO,T.SLIP_LINE_NO 